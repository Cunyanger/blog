import{m as z,u as X,p as I,q as Z,y as ee,t as se,v as te,x,z as F,A as t,B as ae,w as le,D as ie,R as b,E as re,F as ne,G as oe,H as ue,J as ce,K as L,L as P,M as Ee,N as he,O as ve,Q as me,S as Be,T as ge,U as Ae,V as de,W as M,X as ye,Y as D}from"./app-BO9u3XWi.js";const pe=["/","/website.html","/cyber/obsidian.html","/cyber/picbed.html","/cyber/","/cyber/vuepress.html","/cyber/windows.html","/daily/physical%20exercise.html","/notes/literature/1984.html","/notes/literature/To%20Live.html","/notes/social_sciences/Das%20Kapital.html","/notes/social_sciences/Everything%20is%20Negotiable.html","/notes/social_sciences/Flow.html","/notes/social_sciences/Freakonomics.html","/notes/social_sciences/Huangdi%20Neijing.html","/notes/social_sciences/I%20Ching.html","/notes/social_sciences/Mr.%20Toad%20Goes%20to%20Therapy.html","/notes/social_sciences/Selected%20Works%20of%20Mao%20Zedong.html","/notes/social_sciences/Shang%20Jun%20Shu.html","/notes/social_sciences/Tao%20Te%20Ching.html","/notes/social_sciences/The%20Art%20of%20War.html","/notes/social_sciences/The%20Crowd.html","/notes/social_sciences/The%20Willpower%20Instinct.html","/notes/software/Agile%20Software%20Development_%20Principles_%20Patterns_%20and%20Practices.html","/notes/software/Computer%20Networking%20A%20Top-Down%20Approach.html","/notes/software/Effective%20Java.html","/notes/software/Head%20First%20Design%20Patterns.html","/notes/software/JavaScript-The%20Definitive%20Guide.html","/notes/software/Linux%20Private%20Dishes.html","/notes/software/On%20Java%208.html","/notes/software/Professional%20JavaScript%20for%20Web%20Developers.html","/notes/software/SQL%20Antipatterns-Avoiding%20the%20Pitfalls%20of%20Database%20Programming.html","/notes/software/The%20Mythical%20Man-Month.html","/404.html","/daily/","/notes/literature/","/notes/","/notes/social_sciences/","/notes/software/","/category/","/category/%E5%AF%BC%E8%88%AA/","/category/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/category/%E7%94%9F%E6%B4%BB/","/category/%E8%AF%BB%E4%B9%A6/","/tag/","/tag/%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE/","/tag/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/tag/markdown/","/tag/%E5%8D%9A%E5%AE%A2/","/tag/%E5%9B%BE%E5%BA%8A/","/tag/%E6%BF%80%E6%B4%BB/","/tag/windows/","/tag/office/","/tag/%E9%94%BB%E7%82%BC/","/tag/%E6%B4%BB%E7%9D%80/","/tag/%E6%96%87%E5%AD%A6/","/tag/%E8%B5%84%E6%9C%AC%E8%AE%BA/","/tag/%E7%A4%BE%E7%A7%91/","/tag/%E8%B0%88%E5%88%A4/","/tag/%E5%BF%83%E6%B5%81/","/tag/%E5%8F%AF%E4%B9%90%E7%89%9B%E5%A5%B6%E7%BB%8F%E6%B5%8E%E5%AD%A6/","/tag/%E9%BB%84%E5%B8%9D%E5%86%85%E7%BB%8F/","/tag/%E5%91%A8%E6%98%93/","/tag/%E8%9B%A4%E8%9F%86%E5%85%88%E7%94%9F%E5%8E%BB%E7%9C%8B%E5%BF%83%E7%90%86%E5%8C%BB%E7%94%9F/","/tag/%E6%AF%9B%E9%80%89/","/tag/%E5%95%86%E5%90%9B%E4%B9%A6/","/tag/%E9%81%93%E5%BE%B7%E7%BB%8F/","/tag/%E5%AD%99%E5%AD%90%E5%85%B5%E6%B3%95/","/tag/%E4%B9%8C%E5%90%88%E4%B9%8B%E4%BC%97/","/tag/%E8%87%AA%E6%8E%A7%E5%8A%9B/","/tag/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%EF%BC%9A%E5%8E%9F%E5%88%99%E3%80%81%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%AE%9E%E8%B7%B5/","/tag/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/","/tag/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95/","/tag/%E7%BD%91%E7%BB%9C/","/tag/effective-java/","/tag/java/","/tag/head-first-design-patterns/","/tag/head-first-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","/tag/javascript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97/","/tag/js/","/tag/%E9%B8%9F%E5%93%A5%E7%9A%84linux%E7%A7%81%E6%88%BF%E8%8F%9C/","/tag/linux/","/tag/on-java-8/","/tag/javascript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/","/tag/sql-%E5%8F%8D%E6%A8%A1%E5%BC%8F/","/tag/sql/","/tag/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",g=M(fe,[]),Fe=()=>{const{queryHistoryCount:l}=D;return{enabled:l>0,queryHistories:g,addQueryHistory:n=>{g.value=Array.from(new Set([n,...g.value.slice(0,l-1)]))},removeQueryHistory:n=>{g.value=[...g.value.slice(0,n),...g.value.slice(n+1)]}}},R=l=>pe[l.id]+("anchor"in l?`#${l.anchor}`:""),De="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:j}=D,A=M(De,[]),we=()=>({enabled:j>0,resultHistories:A,addResultHistory:r=>{{const n={link:R(r),display:r.display};"header"in r&&(n.header=r.header),A.value=[n,...A.value.slice(0,j-1)]}},removeResultHistory:r=>{A.value=[...A.value.slice(0,r),...A.value.slice(r+1)]}}),Ce=l=>{const r=Ee(),n=I(),w=he(),o=x(0),d=F(()=>o.value>0),E=ve([]);return me(()=>{const{search:C,terminate:v}=Be(),y=Ae(m=>{const{resultsFilter:H=a=>a,querySplitter:B,suggestionsFilter:T,...i}=r.value;m?(o.value+=1,C(m,n.value,i).then(a=>H(a,m,n.value,w.value)).then(a=>{o.value-=1,E.value=a}).catch(a=>{console.warn(a),o.value-=1,o.value||(E.value=[])})):E.value=[]},D.searchDelay-D.suggestDelay,{maxWait:5e3});ge([l,n],([m])=>y(m.join(" "))),de(()=>{v()})}),{isSearching:d,results:E}};var Se=z({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const n=X(),w=I(),o=Z(ee),{addQueryHistory:d,queryHistories:E,removeQueryHistory:C}=Fe(),{resultHistories:v,addResultHistory:y,removeResultHistory:m}=we(),H=se(l,"queries"),{results:B,isSearching:T}=Ce(H),i=te({isQuery:!0,index:0}),a=x(0),h=x(0),q=F(()=>E.value.length>0||v.value.length>0),S=F(()=>B.value.length>0),k=F(()=>B.value[a.value]||null),$=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?v.value.length-1:E.value.length-1):i.index=s-1},J=()=>{const{isQuery:e,index:s}=i;s===(e?E.value.length-1:v.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},W=()=>{a.value=a.value>0?a.value-1:B.value.length-1,h.value=k.value.contents.length-1},O=()=>{a.value=a.value<B.value.length-1?a.value+1:0,h.value=0},U=()=>{h.value<k.value.contents.length-1?h.value+=1:O()},N=()=>{h.value>0?h.value-=1:W()},_=e=>e.map(s=>ye(s)?s:t(s[0],s[1])),Y=e=>{if(e.type==="customField"){const s=ue[e.index]||"$content",[u,f=""]=ce(s)?s[w.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",_([u,...c,f])))}return e.display.map(s=>t("div",_(s)))},p=()=>{a.value=0,h.value=0,r("updateQuery",""),r("close")},G=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.queryHistory),E.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t(L,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:u=>{u.preventDefault(),u.stopPropagation(),C(s)}})]))])),K=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.resultHistory),v.value.map((e,s)=>t(b,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{p()}},()=>[t(L,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(u=>_(u)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:u=>{u.preventDefault(),u.stopPropagation(),m(s)}})]))]));return ae("keydown",e=>{if(l.isFocusing){if(S.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")U();else if(e.key==="Enter"){const s=k.value.contents[h.value];d(l.queries.join(" ")),y(s),n.push(R(s)),p()}}else if(e.key==="ArrowUp")$();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",E.value[s]),e.preventDefault()):(n.push(v.value[s].link),p())}}}),le([a,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!S.value:!q.value}],id:"slimsearch-results"},l.queries.length?T.value?t(ie,{hint:o.value.searching}):S.value?t("ul",{class:"slimsearch-result-list"},B.value.map(({title:e,contents:s},u)=>{const f=a.value===u;return t("li",{class:["slimsearch-result-list-item",{active:f}]},[t("div",{class:"slimsearch-result-title"},e||o.value.defaultTitle),s.map((c,V)=>{const Q=f&&h.value===V;return t(b,{to:R(c),class:["slimsearch-result-item",{active:Q,"aria-selected":Q}],onClick:()=>{d(l.queries.join(" ")),y(c),p()}},()=>[c.type==="text"?null:t(c.type==="title"?re:c.type==="heading"?ne:oe,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",Y(c))])])})])})):o.value.emptyResult:q.value?[G(),K()]:o.value.emptyHistory)}});export{Se as default};
